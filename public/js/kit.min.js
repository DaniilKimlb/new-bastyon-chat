SubscribePrivate=function(){var e=this;return e.address={set:function(e){this.v=e},v:""},e.validation=function(){if(!e.address.v)return"address"},e.serialize=function(){return e.address.v},e.export=function(t){return t?{type:e.type,vsaddress:e.address.v}:{address:e.address.v}},e.import=function(t){t.address&&(e.address.v=t.address),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="subscribePrivate",e},Subscribe=function(){var e=this;return e.address={set:function(e){this.v=e},v:""},e.validation=function(){if(!e.address.v)return"address"},e.serialize=function(){return e.address.v},e.export=function(t){return t?{type:e.type,vsaddress:e.address.v}:{address:e.address.v}},e.import=function(t){t.address&&(e.address.v=t.address),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="subscribe",e},Unsubscribe=function(){var e=this;return e.address={set:function(e){this.v=e},v:""},e.validation=function(){if(!e.address.v)return"address"},e.serialize=function(){return e.address.v},e.export=function(t){return t?{type:e.type,vsaddress:e.address.v}:{type:e.type,address:e.address.v}},e.import=function(t){t.address&&(e.address.v=t.address),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="unsubscribe",e},Blocking=function(){var e=this;return e.address={set:function(e){this.v=e},v:""},e.validation=function(){if(!e.address.v)return"address"},e.serialize=function(){return e.address.v},e.export=function(t){return t?{type:e.type,vsaddress:e.address.v}:{address:e.address.v}},e.import=function(t){t.address&&(e.address.v=t.address),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="blocking",e},Unblocking=function(){var e=this;return e.address={set:function(e){this.v=e},v:""},e.validation=function(){if(!e.address.v)return"address"},e.serialize=function(){return e.address.v},e.export=function(t){return t?{type:e.type,vsaddress:e.address.v}:{address:e.address.v}},e.import=function(t){t.address&&(e.address.v=t.address),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="unblocking",e},Comment=function(e){var t=this;return t.postid=e,t.id="",t.parentid="",t.answerid="",t.amount={set:function(e){this.v=e||0,t.on.change&&t.on.change("fees",this.v)},v:0},t.fees={set:function(e){this.v=e||0,t.on.change&&t.on.change("fees",this.v)},v:0},t.message={set:function(e){this.v=e||"",t.on.change&&t.on.change("message",this.v)},v:""},t.images={set:function(e){if(e)if(_.isArray(e)){if(e.length>10)return!1;this.v=e}else{if(!e)return;if(this.v.length>9)return!1;this.v.push(e)}else this.v=[];return t.on.change&&t.on.change("images",this.v),!0},remove:function(e){e?removeEqual(this.v,e):this.v=[]},get:function(){return _.map(this.v,(function(e){return e}))},v:[]},t.donate={set:function(e){if(e)if(_.isArray(e))this.v=e;else{if(!e)return;this.v.push(e)}else this.v=[];return t.on.change&&t.on.change("donate",this.v),!0},remove:function(e){e?removeEqual(this.v,e):this.v=[]},get:function(){return _.map(this.v,(function(e){return e}))},v:[]},t.url={set:function(e){this.v=e||"",t.on.change&&t.on.change("url",this.v)},v:""},t.clear=function(){t.message.set(),t.images.set(),t.url.set(),t.donate.set(),t.fees.set(),t.delete=!1},t.on={},t.off=function(e){delete t.on[e]},t.validation=function(){return(!t.delete||!t.id)&&(t.images.v.length||t.url.v||t.message.v?t.message.v&&t.message.v.length>2e3?"messagelength":null:"content")},t.checkloaded=function(){return _.find(t.images.v,(function(e){return e.indexOf("data:image")>-1}))},t.uploadImages=function(e,s){lazyEach({array:t.images.v,action:function(s,n){var i=s.item;i.indexOf("data:image")>-1?e.imageUploader.upload({base64:i}).then((e=>{t.images.v[n]=e,s.success()})).catch((e=>{s.success()})):s.success()},all:{success:function(){s&&s()}}})},t.serialize=function(){var e=t.postid;return t.delete||(e+=JSON.stringify({message:t.message.v,url:t.url.v,images:_.map(t.images.v,(function(e){return e}))})),e+=(t.parentid||"")+(t.answerid||"")},t.export=function(e){var s={postid:t.postid,answerid:t.answerid||"",parentid:t.parentid||""};return t.delete?s.delete=t.delete:e?s.msgparsed={message:t.message.v,url:t.url.v,images:t.images.v}:s.msg=JSON.stringify({message:t.message.v,url:t.url.v,images:_.map(t.images.v,(function(e){return e}))}),t.id&&(s.id=t.id),t.donate&&t.donate.v.length&&(s.donate=t.donate.v),e&&(s.type=t.type),s},t.import=function(e){t.postid=e.postid,t.answerid=e.answerid,t.parentid=e.parentid,e.msg&&(e.msgparsed=JSON.parse(e.msg),t.url.set(decodeURIComponent(e.msgparsed.url)),t.message.set(decodeURIComponent(e.msgparsed.message)),t.images.set(_.map(e.msgparsed.images,(function(e){return decodeURIComponent(e)})))),e.msgparsed&&(t.url.set(e.msgparsed.url),t.message.set(e.msgparsed.message),t.images.set(e.msgparsed.images)),e.donate&&t.donate.set(e.donate),(e.txid||e.id)&&(t.id=e.txid||e.id),e.delete&&(t.delete=e.delete)},t.alias=function(){var e=new pComment;return e.import(t.export(!0)),e.id=t.id,e.postid=t.postid,t.delete&&(e.deleted=!0),e},t.typeop=function(){return t.id?t.delete?"commentDelete":"commentEdit":t.type},t.ustate="comment",t.type="comment",t},СScore=function(){var e=this;return e.comment={set:function(e){this.v=e},v:""},e.address={set:function(e){this.v=e},v:""},e.value={set:function(e){this.v=e},v:0},e.ustate="comment_score",e.opreturn=function(){return e.address.v+" "+e.value.v},e.validation=function(){if(!e.comment.v||!e.address.v)return"comment"},e.serialize=function(){return e.comment.v+e.value.v},e.export=function(t){return t?{type:e.type,commentid:e.comment.v,value:e.value.v.toString(),vsaddress:e.address.v}:{commentid:e.comment.v,value:e.value.v.toString()}},e.import=function(t){t.commentid&&(e.comment.v=t.commentid),t.value&&(e.value.v=Number(t.value)),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="cScore",e},UpvoteShare=function(){var e=this;return e.share={set:function(e){this.v=e},v:""},e.address={set:function(e){this.v=e},v:""},e.value={set:function(e){this.v=e},v:""},e.ustate="score",e.opreturn=function(){return e.address.v+" "+e.value.v},e.validation=function(){if(!e.share.v||!e.value.v)return"share"},e.serialize=function(){return e.share.v+e.value.v},e.export=function(t){return t?{type:e.type,share:e.share.v,value:e.value.v,vsaddress:e.address.v}:{share:e.share.v,value:e.value.v}},e.import=function(t){t.share&&(e.share.v=t.share),t.value&&(e.value.v=t.value),t.vsaddress&&(e.address.v=t.vsaddress)},e.type="upvoteShare",e},ComplainShare=function(){var e=this;return e.share={set:function(e){this.v=e},v:""},e.reason={set:function(e){this.v=e},v:""},e.validation=function(){return e.share.v?e.reason.v?void 0:"reason":"share"},e.serialize=function(){return e.share.v+"_"+e.reason.v},e.export=function(t){return t?{type:e.type,share:e.share.v,reason:e.reason.v}:{share:e.share.v,reason:e.reason.v}},e.import=function(t){t.share&&(e.share.v=t.share),t.reason&&(e.reason.v=t.reason)},e.type="complainShare",e},ModFlag=function(){var e=this;return e.s2={set:function(e){this.v=e},v:""},e.s3={set:function(e){this.v=e},v:""},e.i1={set:function(e){this.v=e},v:""},e.validation=function(){return e.s3.v?e.i1.v?void 0:"reason":"address"},e.serialize=function(){return e.s2.v+e.s3.v+e.i1.v},e.export=function(t){return t?{type:e.type,s2:e.s2.v,s3:e.s3.v,i1:e.i1.v}:{s2:e.s2.v,s3:e.s3.v,i1:e.i1.v}},e.import=function(t){t.s2&&(e.s2.v=t.s2),t.s3&&(e.s3.v=t.s3),t.i1&&(e.i1.v=t.i1)},e.type="modFlag",e},ContentBoost=function(e){var t=this;return t.txid=e,t.amount={set:function(e){this.v=e},v:""},t.ustate="contentBoost",t.validation=function(){return!t.amount.v&&"amount"},t.serialize=function(){return t.txid},t.export=function(e){return e?{type:t.type,content:t.txid}:{content:t.txid}},t.import=function(e){e.amount&&e.txid&&(t.amount.v=e.amount),t.txid=e.txid},t.type="contentBoost",t.typeop=function(){return t.type},t},Share=function(e){var t=this;return t.clear=function(){t.message.set(),t.images.set(),t.tags.set(),t.url.set(),t.caption.set(),t.repost.set(),t.language.set(e),t.aliasid="",_.each(t.settings,(function(e,s){t.settings[s]=null}))},t.repost={set:function(e){this.v=e||"",_.each(t.on.change||{},(function(e){e("repost",this.v)}))},v:"",drag:!1},t.caption={set:function(e){this.v=e||"",_.each(t.on.change||{},(function(e){e("caption",this.v)}))},v:"",drag:!1},t.message={set:function(e){this.v=e||"",_.each(t.on.change||{},(function(e){e("message",this.v)}))},v:"",drag:!0},t.language={set:function(e){this.v=e||"",_.each(t.on.change||{},(function(e){e("language",this.v)}))},get:function(){return this.v},v:""},t.poll={set:function(e){this.v=e||{},_.each(t.on.change||{},(function(e){e("poll",this.v)}))},remove:function(e){e?removeEqual(this.v,e):this.v={},_.each(t.on.change||{},(function(e){e("poll",this.v)}))},get:function(){return this.v},v:{},drag:!0},t.ustate=function(){return t.aliasid?"":t.itisvideo()?"video":t.itisaudio()?"audio":t.itisarticle()?"article":"post"},t.tags={have:function(e){return this.v.indexOf(e)>-1},set:function(e){if(void 0===e)this.v=[];else if(_.isArray(e)){if("undefined"!=typeof app)if(app.platform.sdk.categories.fromTags(e,t.language.v).categories.length>2)return!1;if(e.length>15)return!1;e=_.map(e,(function(e){return clearTagString(e)})),this.v=e}else{if(!e)return;e=clearTagString(e);var s=_.uniq(_.clone(this.v).concat(e));if("undefined"!=typeof app)if(app.platform.sdk.categories.fromTags(s,t.language.v).categories.length>2)return!1;if(s.length>15)return!1;this.v=s}return _.each(t.on.change||{},(function(e){e("tags",this.v)})),!0},remove:function(e){e?(removeEqual(this.v,e),_.each(t.on.change||{},(function(e){e("tags",this.v)}))):this.v=[]},get:function(){return _.map(this.v,(function(e){return e}))},v:[]},t.images={set:function(e){if(e)if(_.isArray(e)){if(e.length>10)return!1;this.v=e}else{if(!e)return;if(this.v.length>9)return!1;this.v.push(e)}else this.v=[];return _.each(t.on.change||{},(function(e){e("images",this.v)})),!0},remove:function(e){e?removeEqual(this.v,e):this.v=[],_.each(t.on.change||{},(function(e){e("images",this.v)}))},get:function(){return _.map(this.v,(function(e){return e}))},v:[],drag:!0},t.url={set:function(e){return this.v=e||"",t.settings.image="",_.each(t.on.change||{},(function(e){e("url",this.v)})),!0},v:"",drag:!0},t.on={change:{}},t.off=function(e){delete t.on[e]},t.default={a:["cm","r","i","u","p"],v:"p",videos:[],image:"a",f:"0",c:""},t.settings={a:"",v:"",videos:[],image:"",f:"0",c:""},t.checkloaded=function(){return _.find(t.images.v,(function(e){return e.indexOf("data:image")>-1}))},t.uploadImages=function(e,s){lazyEach({array:t.images.v,action:function(s,n){var i=s.item;i.indexOf("data:image")>-1?e.imageUploader.upload({base64:i}).then((e=>{t.images.v[n]=e,s.success()})).catch((e=>{s.success()})):s.success()},all:{success:function(){s&&s()}}})},t.validation=function(){if(t.delete)return!1;if(!t.message.v&&!t.caption.v&&!t.repost.v)return"message";if(!t.language.v)return"language";if((t.itisvideo()||t.itisaudio())&&!t.caption.v)return"videocaption";if(t.url.v&&t.url.v.length&&!t.itisvideo()&&!t.itisaudio()&&(trim((trim(t.message.v)+trim(t.caption.v)).replace(t.url.v,"")).length<30&&!t.images.v.length))return"url";return t.tags.v.length||t.repost.v?!(!t.hasexchangetag()||!(t.tags.v.length>1||t.repost.v||t.itisvideo()||t.itisaudio()||t.url.v&&t.url.v.length))&&"pkoin_commerce_tag":"tags"},t.serialize=function(){var e=t.message.v,s="a"==t.settings.v&&t.settings.version&&t.settings.version>=2;return s&&(e=JSON.stringify(e)),t.url.v+t.caption.v+e+_.map(t.tags.v,(function(e){return e})).join(",")+t.images.v.join(",")+(t.aliasid||"")+(t.repost.v||"")},t.shash=function(){return bitcoin.crypto.sha256(t.serialize()+(t.repost.v||"")).toString("hex")},t.itisvideo=function(){if("a"!=t.settings.v&&t.url.v){var e=parseVideo(t.url.v),s=t.url.v.replace("peertube://","").split("/");return"peertube"==e.type&&(!s||s.length<=0||"audio"!=s[s.length-1])||void 0}},t.itisaudio=function(){if("a"!=t.settings.v&&t.url.v){var e=parseVideo(t.url.v),s=t.url.v.replace("peertube://","").split("/");return!!("peertube"==e.type&&s&&s.length>0&&"audio"==s[s.length-1])||void 0}},t.itisembed=function(){if("a"===t.settings.v||!t.url?.v)return;const e=parseVideo(t.url.v),s="youtube"===e.type,n="vimeo"===e.type,i="bitchute"===e.type,r="brighteon"===e.type||"stream.brighteon"===e.type,a="ipfs"===e.type;return s||n||i||r||a},t.itisipfs=function(){if("a"===t.settings.v||!t.url?.v)return;return"ipfs"===parseVideo(t.url.v).type},t.itisstream=function(){if("a"!=t.settings.v&&t.url.v)return"peertube"==parseVideo(t.url.v).type&&t.url.v.indexOf("stream")>-1||void 0},t.canSend=function(e,s){return t.itisvideo()&&!t.aliasid?e.peertubeHandler.checkTranscoding(t.url.v).then((e=>s(e))):s(!0)},t.itisarticle=function(){return"a"==t.settings.v&&t.settings.version&&t.settings.version>=2},t.hasexchangetag=function(){return t.tags.have("pkoin_commerce")},t.export=function(e){var s=t.message.v;"a"==t.settings.v&&t.settings.version&&t.settings.version;return e?{type:t.type,caption:t.caption.v,message:s,url:t.url.v,tags:t.tags.v,images:t.images.v,settings:_.clone(t.settings),language:t.language.v,txidEdit:t.aliasid||"",txidRepost:t.repost.v||"",poll:t.poll.v||{}}:{c:t.caption.v,m:s,u:t.url.v,p:_.clone(t.poll.v),t:_.map(t.tags.v,(function(e){return e})),i:t.images.v,s:_.clone(t.settings),l:t.language.v,txidEdit:t.aliasid||"",txidRepost:t.repost.v||""}},t.import=function(e){if(e.s)try{t.settings=e.s}catch(e){}else e.settings&&(t.settings=e.settings);"a"==t.settings.v&&t.settings.version&&t.settings.version;var s=e.m||e.message;t.caption.set(e.c||e.caption),t.url.set(e.u||e.url),t.tags.set(e.t||e.tags),t.message.set(s),t.images.set(e.i||e.images),t.repost.set(e.r||e.txidRepost||e.repost),t.language.set(e.l||e.language||"en"),t.poll.set(e.p||e.poll||{}),e.txidEdit&&(t.aliasid=e.txidEdit)},t.alias=function(e){var s=new pShare;return s.time=new Date,s._import(t.export(!0)),s.txid=e||t.aliasid,s},t.optstype=function(){return t.itisvideo()?"video":t.itisaudio()?"audio":t.itisarticle()?"article":t.type},t.typeop=function(){return t.itisvideo()?"video":t.itisaudio()?"audio":t.itisarticle()?"article":t.aliasid?"share":t.type},t.size=function(){return JSON.stringify(t.export()).replace(/base64,[^ ",]*/g,"fileinb64").replace(/base64%2C[^ ",]*/g,"fileinb64").length},t.sizelimit=function(){return t.itisarticle()&&!window.testpocketnet?12e4:6e4},e&&t.language.set(e),t.type="share",t},UserInfo=function(){var e=this;return e.clear=function(){e.image.set(),e.name.set(),e.language.set(),e.about.set(),e.site.set(),e.addresses.set()},e.checkloaded=function(){return e.image.v.indexOf("data:image")>-1},e.addresses={set:function(t){var s=this.v;t?_.isArray(t)?_.each(t,(function(e){s.push(e)})):this.v.push(t):this.v=[],e.on.change&&e.on.change("addresses",this.v)},v:[]},e.keys={set:function(t){var s=this.v;t?_.isArray(t)?_.each(t,(function(e){e&&s.push(e)})):this.v.push(t):this.v=[],e.on.change&&e.on.change("keys",this.v)},v:[]},e.image={set:function(t){this.v=t||"",e.on.change&&e.on.change("image",this.v)},v:""},e.name={set:function(t){this.v=t||"",e.on.change&&e.on.change("name",this.v)},v:""},e.ref={set:function(t){this.v=t||"",e.on.change&&e.on.change("ref",this.v)},v:""},e.language={set:function(t){this.v=t||"",e.on.change&&e.on.change("language",this.v)},v:""},e.about={set:function(t){this.v=t||"",e.on.change&&e.on.change("about",this.v)},v:""},e.site={set:function(t){this.v=t||"",e.on.change&&e.on.change("site",this.v)},v:""},e.uploadImage=function(t,s){var n=e.image.v;n.indexOf("data:image")>-1?n.split(",")[1]&&t.imageUploader.upload({base64:n,type:"avatar"}).then((t=>{e.image.v=t,s&&s()})).catch((e=>{s&&s(e)})):s&&s()},e.on={},e.off=function(t){delete e.on[t]},e.validation=function(){if(e.name.v.length>20)return"namelength";var t=e.name.v.toLowerCase().replace(/[^a-z]/g,"");if(!window.app?.platform?.whiteList?.includes(app.user.address.value)){if(t.indexOf("pocketnet")>-1)return"pocketnet";if(t.indexOf("bastyon")>-1)return"bastyon"}return!1},e.serialize=function(){return e.name.v+e.site.v+e.language.v+e.about.v+e.image.v+JSON.stringify(e.addresses.v)+e.ref.v+e.keys.v.join(",")},e.alias=function(t){var s=new pUserInfo;return s._import(e.export()),s.subscribers_loaded=!0,s.subscribes_loaded=!0,s.blocking_loaded=!0,s.txid=t,s},e.export=function(t){return t?{type:e.type,name:e.name.v,about:e.about.v,site:e.site.v,language:e.language.v,image:e.image.v,addresses:JSON.stringify(e.addresses.v||[]),ref:e.ref.v,keys:e.keys.v.join(",")}:{n:e.name.v,l:e.language.v,a:e.about.v,s:e.site.v,i:e.image.v,b:JSON.stringify(e.addresses.v||[]),r:e.ref.v,k:e.keys.v.join(",")}},e.import=function(t){e.name.set(t.c||t.name),e.language.set(t.l||t.language),e.about.set(t.a||t.about),e.site.set(t.s||t.site),e.image.set(t.i||t.image),e.addresses.set(JSON.parse(t.b||t.addresses||"[]")),e.ref.set(t.r||t.ref),e.keys.set((t.k||t.keys||"").split(","))},e.type="userInfo",e},DeleteAccount=function(){var e=this;e.validation=function(){return!1},e.serialize=function(){return""},e.export=function(t){return t?{type:e.type}:{}},e.import=function(e){},e.type="accDel",e.typeop=function(){return e.type}},Transaction=function(){var e=this;e.source={set:function(e){this.v=e||[]},v:[]},e.reciever={set:function(e){this.v=_.filter(e||[],(e=>e.address&&e.amount))},v:[]},e.feemode={set:function(e){this.v="exclude","exclude"!=e&&"include"!=e||(this.v=e)},v:"exclude"},e.message={set:function(e){this.v=e||""},v:""},e.validation=function(){return!1},e.export=function(t){return{type:e.type,reciever:e.reciever.v,feemode:e.feemode.v,message:e.message.v,source:e.source.v}},e.import=function(t){e.reciever.set(t.reciever),e.feemode.set(t.feemode),e.message.set(t.message),e.source.set(t.source)},e.type="transaction"},pUserInfo=function(){var e=this;e.name="",e.image="",e.language="",e.about="",e.site="",e.txid="",e.ref="",e.postcnt=0,e.reputation=0,e.trial=!0,e.keys=[],e.deleted=!1,e.subscribes=[],e.subscribers=[],e.subscribes_loaded=!1,e.subscribers_loaded=!1,e.blocking_loaded=!1,e.dev=!1,e.recomendedSubscribes=[],e.blocking=[],e.regdate=new Date,e.subscribers_count=0,e.subscribes_count=0,e.blockings_count=0,e.likers_count=0,e.flags={},e.firstFlags={},e.address="",e.rc=0,e.content={},e.objectid=makeid(),e._import=function(t){e.name=t.n||t.name||"",e.image=t.i||t.image,e.about=t.a||t.about||"",e.language=t.l||t.language,e.site=t.s||t.site||"",e.ref=t.r||t.ref,e.rc=t.rc||0,e.postcnt=t.postcnt||0,e.reputation=t.reputation||0,e.deleted=t.deleted||!1,t.subscribes&&(e.subscribes=t.subscribes),t.subscribers&&(e.subscribers=t.subscribers),t.subscribes_count&&(e.subscribes_count=t.subscribes_count),t.subscribers_count&&(e.subscribers_count=t.subscribers_count),t.recomendedSubscribes&&(e.recomendedSubscribes=t.recomendedSubscribes),t.blocking&&(e.blocking=t.blocking),t.blockings_count&&(e.blockings_count=t.blockings_count),t.subscribes_loaded&&(e.subscribes_loaded=!0),t.blockings_loaded&&(e.blockings_loaded=!0),t.subscribers_loaded&&(e.subscribers_loaded=!0),t.flags&&(e.flags=t.flags),t.hash&&(e.hash=t.hash),t.firstFlags&&(e.firstFlags=t.firstFlags),t.likers_count&&(e.likers_count=t.likers_count),t.content&&(e.content=t.content),e.keys=t.k||t.keys||"",_.isArray(e.keys)||(e.keys=e.keys.split(",")),e.keys=_.filter(e.keys,(function(e){return e})),t.txid&&(e.txid=t.txid);try{e.addresses=[];var s=t=>{var n=JSON.parse(t);n.length&&n.forEach((t=>{"string"==typeof t?s(t):"object"==typeof t&&e.addresses.push(t)}))};s(t.b||t.addresses||"[]")}catch(t){e.addresses=[]}void 0!==t.trial&&(e.trial=t.trial),(t.adr||t.address)&&(e.address=t.adr||t.address),e.temp=t.temp||null,e.dev=t.dev,t.regdate&&e.regdate.setTime(1e3*t.regdate)},e.export=function(){var t={};return t.n=e.name,t.image=e.image,t.a=e.about,t.l=e.language,t.s=e.site,t.r=e.ref,t.rc=e.rc,t.b=JSON.stringify(e.addresses||[]),t.adr=e.address,t.k=e.keys.join(","),t.reputation=e.reputation,t.subscribers=_.clone(e.subscribers),t.subscribes=_.clone(e.subscribes),t.recomendedSubscribes=_.clone(e.recomendedSubscribes),t.blocking=_.clone(e.blocking),t.flags=_.clone(e.flags),t.firstFlags=_.clone(e.firstFlags),t.subscribes_loaded=e.subscribes_loaded,t.blockings_loaded=e.blockings_loaded,t.subscribers_loaded=e.subscribers_loaded,t.subscribers_count=e.subscribers_count,t.subscribes_count=e.subscribes_count,t.blockings_count=e.blockings_count,t.likers_count=e.likers_count,t.postcnt=e.postcnt,t.content=_.clone(e.content),t.dev=e.dev,e.regdate&&e.regdate.getTime&&(t.regdate=e.regdate.getTime()/1e3),t},e.social=function(){return{image:e.image,images:[e.image],title:e.name,html:{body:e.about,preview:e.about},text:{body:e.about,preview:e.about}}},e.import=function(t){t=JSON.parse(t),e._import(t)},e.modFlag=function(t){var s=new ModFlag;return s.s2.set(e.hash),s.s3.set(e.address),s.i1.set(t),s},e.loadRelations=function(t,s){return Promise.all(_.map(t,(t=>e.loadRelation(t,s))))};var t={};return e.relclbks={},e.loadRelation=function(s,n){return e[s+"_loaded"]?Promise.resolve():(t[s]||(t[s]=n(e.address,s).then((t=>t?(e[s]=t,e[s+"_loaded"]=!0,_.each(e.relclbks||{},(e=>{e(s,t)})),Promise.resolve(e[s])):Promise.resolve(null))).catch((e=>(console.error(e),Promise.resolve(null)))).finally((()=>{delete t[s]}))),t[s])},e.relation=function(t,s){return s||(s="subscribes"),_.find(e[s],(function(e){return(e.adddress||e.address||e)==t}))},e.addRelation=function(t,s){s||(s="subscribes"),"subscribers"===s&&(e.subscribers_count||(e.subscribers_count=0),e.subscribers_count++),"subscribes"===s&&(e.subscribes_count||(e.subscribes_count=0),e.subscribes_count++),"blocking"===s&&(e.blockings_count||(e.blockings_count=0),e.blockings_count++),e[s]&&(removeEqual(e[s],t),e[s].push(t))},e.removeRelation=function(t,s){s||(s="subscribes"),"subscribers"===s&&(e.subscribers_count||(e.subscribers_count=1),e.subscribers_count--),"subscribes"===s&&(e.subscribes_count||(e.subscribes_count=1),e.subscribes_count--),"blocking"===s&&(e.blockings_count||(e.blockings_count=1),e.blockings_count--),e[s]&&removeEqual(e[s],t)},e.clone=function(){var s=new pUserInfo;return s._import(e.export()),_.each(t,((e,t)=>{s.setLoadingRelations(e,t)})),s.relclbks[e.objectid]=(t,s)=>{e[t]=s,e[t+"_loaded"]=!0,_.each(e.relclbks||{},(e=>{e(t,s)}))},s.cloned=e.objectid,s},e.setLoadingRelations=function(s,n){t[n]=s,t[n].then((t=>(t&&(e[n]=v,e[n+"_loaded"]=!0),Promise.resolve(t)))).finally((()=>{delete t[n]}))},e.type="userInfo",e},pShare=function(){var e=this;return e.url="",e.tags=[],e.message="",e.caption="",e.images=[],e.txid="",e.repost="",e.language="",e.poll={},e.time=new Date,e.___temp=!1,e.comments=0,e.lastComment=null,e.reposted=0,e.score=0,e.scnt=0,e.address="",e.deleted=!1,e.on={},e.off=function(t){delete e.on[t]},e.default={a:["cm","i","u","p"],v:"p",videos:[],image:"a",f:"0",c:""},e.settings={a:"",v:"",videos:[],image:"",f:"0",c:""},e.isEmpty=function(){return!e.message&&!e.caption&&0==e.tags.length&&0==e.images.length&&!e.url},e.findComment=function(t){return _.find(e.comments,(function(e){return e.txid==t}))},e.itisvideo=function(){if("a"!=e.settings.v&&e.url){var t=parseVideo(e.url),s=e.url.replace("peertube://","").split("/");return"peertube"==t.type&&(!s||s.length<=0||"audio"!=s[s.length-1])||void 0}},e.itisaudio=function(){if("a"!=e.settings.v&&e.url){var t=parseVideo(e.url),s=e.url.replace("peertube://","").split("/");return!!("peertube"==t.type&&s&&s.length>0&&"audio"==s[s.length-1])||void 0}},e.itisembed=function(){if("a"===e.settings.v||!e.url?.v)return;const t=parseVideo(e.url.v),s="youtube"===t.type,n="vimeo"===t.type,i="bitchute"===t.type,r="brighteon"===t.type||"stream.brighteon"===t.type,a="ipfs"===t.type;return s||n||i||r||a},e.itisipfs=function(){if("a"===e.settings.v||!e.url?.v)return;return"ipfs"===parseVideo(e.url.v).type},e.itisstream=function(){if("a"!=e.settings.v&&e.url)return"peertube"==parseVideo(e.url).type&&e.url.indexOf("stream")>-1||void 0},e.hasexchangetag=function(){return e.tags.indexOf("pkoin_commerce")>-1},e.itisarticle=function(){return"a"==e.settings.v&&e.settings.version&&e.settings.version>=2},e._import=function(t){e.settings=t.s||t.settings||{},t.i&&!_.isArray(t.i)&&(t.i=[t.i]),t.t&&!_.isArray(t.t)&&(t.t=[t.t]),e.message=t.m||t.message||"",e.caption=t.c||t.caption||"",e.tags=t.t||t.tags||[],e.url=t.u||t.url||"",e.poll=t.p||t.poll||{},t.myVal&&(e.myVal=Number(t.myVal)),e.language=t.l||t.language||"en",e.images=t.i||t.images||[],e.repost=t.r||t.repost||t.txidRepost||"",e.images=e.images.filter((e=>checkIfAllowedImage(e))),t.deleted&&(e.deleted=!0),t.txid&&(e.txid=t.txid),t.id&&(e.id=t.id),t.___temp&&(e.___temp=t.___temp),t.txidEdit&&(e.txidEdit=t.txidEdit,e.edit=!0),t.edit&&(e.edit=!0),t.scoreSum&&(e.score=Number(t.scoreSum)),t.scoreCnt&&(e.scnt=Number(t.scoreCnt)),e.temp=t.temp||null,t._time&&(e._time=t._time),t.comments&&(e.comments=t.comments),t.reposted&&(e.reposted=t.reposted),t.lastComment&&(e.lastComment=t.lastComment.id||t.lastComment),t.address&&(e.address=t.address),t.time&&e.time.setTime(1e3*t.time)},e.clone=function(){var t=new pShare;return t._import(e.export()),t},e.export=function(){var t={};return t.m=e.message,t.c=e.caption,t.u=e.url,t.t=_.map(e.tags||[],(function(e){return e})),t.i=_.clone(e.images),t._time=e._time||e.time,t.time=e.time.getTime()/1e3,t.s=_.clone(e.settings),t.l=e.language,t.p=e.poll,t.deleted=e.deleted,t.scoreCnt=e.scnt,t.scoreSum=e.score,t.address=e.address,t.txid=e.txid,t.deleted=e.deleted,t.comments=e.comments,t.repost=e.repost,t.txidEdit=e.txidEdit,t.edit=e.edit,t.___temp=e.___temp,e.lastComment&&(t.lastComment=e.lastComment),t},e.import=function(t){t=JSON.parse(t),e._import(t)},e.social=function(t){var s=e.message.v;if(window.cordova&&deep(window,"plugins.socialsharing")&&e.message.blocks){var n=t.platform.api.name(e.address),i=new edjsHTML(null,t),r=i.apply(e.message,decodeURIComponent);s=i.text(r),s=e.caption+"\n\n"+s}else s=e.renders.text(s);var a={image:"",files:e.images||[],title:t.localization.e("postby")+" "+n,html:{body:e.renders.messagec(),preview:trimHtml(e.renders.messagec(),160).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")},text:{body:s,preview:trimHtml(e.renders.text(),130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"..."),title:e.caption}};if(e.url){var o=videoImage(e.url);o&&(a.image=o)}return a.image||(a.image=e.images[0]),a},e.renders={captionclear:function(t){return t||e.caption||""},caption:function(t,s){return t||e.caption?s=trimrn(t||e.caption):e.message.length<100?trimrn(s||e.message):""},message:function(t,s){return!t&&!e.caption&&e.message.length<100?"":s=trimrn(s||e.message)},messagec:function(){return e.caption||trimrn(e.message)},text:function(t){return t||(t=e.renders.messagec()),t=trimrn(filterXSS(t,{whiteList:[],stripIgnoreTag:!0}))}},e.upvote=function(t){if(e.myVal&&"0"!=e.myVal)return null;var s=new UpvoteShare;return s.share.set(e.txid),s.value.set(t),s.address.set(e.address||""),s},e.complain=function(t){var s=new ComplainShare;return s.share.set(e.txid),s.reason.set(t),s},e.modFlag=function(t){var s=new ModFlag;return s.s2.set(e.txid),s.s3.set(e.address),s.i1.set(t),s},e.alias=function(){var t=new Share;return t.import(e),t.aliasid=e.txid,t.time=e.time,t},e.visibility=function(){return"0"==e.settings.f?null:"1"==e.settings.f?"sub":"2"==e.settings.f?"reg":void 0},e.type="share",e},pComment=function(){var e=this;return e.url="",e.message="",e.images=[],e.postid="",e.id="",e.time=new Date,e.timeUpd=new Date,e.children=0,e.amount=0,e.address="",e.parentid="",e.answerid="",e.scoreDown=0,e.scoreUp=0,e.myScore=0,e.deleted=!1,e.address="",e.blck_cnt_cmt=0,e.blck_cmt_cnt=0,e.reputation=0,e.my=function(t){return!(!e.address||e.address!=t.user?.address?.value)},e._import=function(t){t.msgparsed&&(e.url=t.msgparsed.url,e.message=t.msgparsed.message,e.images=t.msgparsed.images),e.postid=t.postid,e.answerid=t.answerid,e.parentid=t.parentid,1==t.blck_cmt_cnt?e.blck_cmt_cnt=1:e.blck_cmt_cnt=0,1==t.blck_cnt_cmt?e.blck_cnt_cmt=1:e.blck_cnt_cmt=0,e.scoreDown=Number(t.scoreDown||"0"),e.scoreUp=Number(t.scoreUp||"0"),e.amount=Number(t.amount||"0"),e.children=Number(t.children||"0"),t.donate&&(e.amount=1e8*_.reduce(t.donate,((e,t)=>e+t.amount),0)),e.address=t.address,e.commentTo=t.commentTo||null,t.addressCommentAnswer&&t.addressCommentAnswer!=e.address&&(e.commentTo=t.addressCommentAnswer),!e.commentTo&&t.addressCommentParent&&t.addressCommentParent!=e.address&&(e.commentTo=t.addressCommentAnswer),!e.commentTo&&t.addressContent&&t.addressContent!=e.address&&(e.commentTo=t.addressContent),t.rating&&(e.rating=t.rating),t.myScore&&(e.myScore=t.myScore),t.deleted&&(e.deleted=!0),(t.id||t.txid)&&(e.id=t.id||t.txid),e.setTime(t.time,t.timeUpd)},e.import=function(t){e._import(t)},e.export=function(){return{id:e.id,postid:e.postid||"",answerid:e.answerid||"",parentid:e.parentid||"",msgparsed:{message:e.message,url:e.url,images:e.images},scoreDown:e.scoreDown,scoreUp:e.scoreUp,myScore:e.myScore,deleted:e.deleted,donation:e.donation,amount:e.amount,address:e.address,children:e.children,time:e.time.getTime()/1e3,timeUpd:e.timeUpd.getTime()/1e3,commentTo:e.commentTo,blck_cmt_cnt:e.blck_cmt_cnt,blck_cnt_cmt:e.blck_cnt_cmt}},e.clone=function(){var t=new pComment;return t._import(e.export()),t},e.upvote=function(t){if(e.myVal&&"0"!=e.myVal)return null;var s=new СScore;return s.comment.set(e.id),s.address.set(e.address||""),s.value.set(t),e.myScore=Number(t),s},e.modFlag=function(t){var s=new ModFlag;return s.s2.set(e.id),s.s3.set(e.address),s.i1.set(t),s},e.delete=function(){var t=new Comment(e.postid);return t.id=e.id,t.parentid=e.parentid,t.answerid=e.answerid,t.delete=!0,t},e.setTime=function(t,s){t&&(e.time=new Date,e.time.setTime(1e3*t)),s&&(e.timeUpd=new Date,e.timeUpd.setTime(1e3*s))},e.social=function(t){var s=t.platform.api.name(e.address),n={image:"",images:e.images||[],title:"Comment by "+s,html:{body:e.renders.text(),preview:trimHtml(e.renders.text(),160).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")},text:{body:e.renders.text(),preview:trimHtml(e.renders.text(),130).replace(/ &hellip;/g,"...").replace(/&hellip;/g,"...")}};return n.image||(n.image=e.images[0]),n.image||(n.image=t.platform.psdk.userInfo.getShortForm(e.address).image),n},e.renders={text:function(){return trimrn(filterXSS(e.message,{whiteList:[],stripIgnoreTag:!0}))},preview:function(){var t=filterXSS(e.message,{whiteList:[],stripIgnoreTag:!0}),s=joypixels.toImage(trimHtml(t,90));return nl2br(trimrn(s))},previewEmojidis:function(){var t=filterXSS(e.message,{whiteList:[],stripIgnoreTag:!0}),s=trimHtml(t,90);return nl2br(trimrn(s))}},e.type="comment",e},Img=function(e){e||(e={});var t=this;return t.type=e.type,t.name=e.name,t.app=e.app,t.refId=e.refId,t},Remove=function(){var e=this;return e.clear=function(){e.txidEdit.set(),e.s.set()},e.txidEdit={set:function(e){this.v=e},v:""},e.ustate=function(){return e.type},e.on={change:{}},e.off=function(t){delete e.on[t]},e.checkloaded=function(){return!1},e.validation=function(){return!1},e.serialize=function(){return e.txidEdit.v},e.shash=function(){return bitcoin.crypto.sha256(e.serialize()).toString("hex")},e.export=function(t){var s={txidEdit:e.txidEdit.v||""};return t&&(s.type=e.type),s},e.import=function(t){e.txidEdit.set(t.txidEdit||"")},e.alias=function(){var t=new pRemove;return t._import(e.export()),t},e.optstype=function(){return e.type},e.typeop=function(){return e.type},e.type="contentDelete",e},pRemove=function(){var e=this;return e.txidEdit="",e.s="",e.on={},e.off=function(t){delete e.on[t]},e.isEmpty=function(){return!e.txidEdit&&!e.s},e._import=function(t,s){t.txidEdit&&(e.txidEdit=t.txidEdit),t.s&&(e.s=t.s)},e.export=function(){var t={};return t.txidEdit=e.txidEdit,t.s&&(t.s=e.s),t},e.import=function(t){t=JSON.parse(t),e._import(t)},e.alias=function(){var t=new Remove;return t.import(e),t.txidEdit=e.txidEdit,t.s&&(t.s=e.s),t},e.type="contentDelete",e},Settings=function(){var e=this;return e.pin={set:function(t){this.v=t||"",_.each(e.on.change||{},(function(e){e("pin",this.v)}))},get:function(){return this.v},v:""},e.clear=function(){e.pin.set()},e.ustate=function(){return e.type},e.on={change:{}},e.off=function(t){delete e.on[t]},e.checkloaded=function(){return!1},e.validation=function(){return!1},e.serialize=function(){return JSON.stringify({pin:e.pin.v})},e.shash=function(){return bitcoin.crypto.sha256(e.serialize()).toString("hex")},e.export=function(t){return t?{type:e.type,d:JSON.stringify({pin:e.pin.v||""})}:{d:JSON.stringify({pin:e.pin.v||""})}},e.import=function(t={}){t.d||(t.d="{}");var s={};if(_.isObject(t.d))s=t.d;else try{s=JSON.parse(t.d)}catch(e){s={}}e.pin.set(s.pin||"")},e.optstype=function(){return e.type},e.typeop=function(){return e.type},e.alias=function(){var t=new pSettings;return t.import(e.export(!0)),t},e.type="accSet",e},pSettings=function(){var e=this;return e.pin="",e.address="",e._import=function(t={}){var s=t.d;e.pin=(s||{}).pin||"",e.address=(s||{}).address||""},e.export=function(){return{d:{pin:e.pin}}},e.import=function(t={}){t.d||(t.d="{}");var s={};if(_.isObject(t.d))s=t.d;else try{s=JSON.parse(t.d)}catch(e){s={}}e._import({d:s})},e.alias=function(){var t=new Settings;return t.import({d:{pin:e.pin}}),t},e.clone=function(){var t=new pSettings;return t._import(e.export()),t.address=e.address,t},e.type="accSet",e},kits={c:{userInfo:UserInfo,share:Share,complainShare:ComplainShare,modFlag:ModFlag,upvoteShare:UpvoteShare,cScore:СScore,comment:Comment,unblocking:Unblocking,blocking:Blocking,unsubscribe:Unsubscribe,subscribe:Subscribe,subscribePrivate:SubscribePrivate,contentBoost:ContentBoost,deleteAccount:DeleteAccount,accDel:DeleteAccount,transaction:Transaction,contentDelete:Remove,accSet:Settings},ini:{},alias:{userInfo:pUserInfo,share:pShare,comment:pComment,contentDelete:pRemove,settings:pSettings}};