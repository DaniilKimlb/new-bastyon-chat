var electron=null;"undefined"!=typeof _Electron&&(electron=require("electron"));var WssDummy=function(e){var n=this;return n.ip="localhost",n.onmessage=null,n.onopen=null,n.send=function(n){e.wsssend(n)},n.recieve=function(e){n.onmessage&&n.onmessage(e)},n.close=function(){n.onmessage=null,n.onopen=null,n.onclose&&n.onclose(),n.onclose=null},n.init=function(){n.onopen&&n.onopen()},n},System16=function(e,n,t){var s=this,r={};s.wssdummy=new WssDummy(s);var o={hash:[],tick:{}},i=function(e,n){s.wssdummy.recieve(n)},c=function(e,n){var t=r[n.id];t&&(t.clbk&&t.clbk(n.error,n.data),delete r[n.id])},a=function(e,n){var t=n.data;if(t){var r=t.settings||{},i=bitcoin.crypto.hash256(JSON.stringify(r)),c=i.join("")!==o.hash.join("");o.hash=i,o.tick=r,_.each(s.clbks.tick,(e=>{e(o.tick,t.state,c)}))}};s.tick=function(e){a(0,e)},s.clbks={tick:{}},s.settings={server:{enabled:{type:"BOOLEAN"},ports:{},iplimiter:{},captcha:{type:"BOOLEAN"},ssl:{},firebase:{}},wallet:{addresses:{}},admins:{},node:{enabled:{type:"BOOLEAN"},binPath:{type:"FILE_SELECT"},dataPath:{type:"FILE_SELECT"},stacking:{}}};var u=function(n){return n.id=makeid(),n.data||(n.data={}),function(n){var t=null;if(e.user&&1==e.user.getstate())try{t=e.user.signature()}catch(e){}t&&(n.signature=t)}(n.data),electron.ipcRenderer.send("proxy-message",n),new Promise(((e,t)=>{r[n.id]={id:n.id,clbk:function(n,s){n?t(n):e(s)}}}))};return s.request=function(e,s){var r={action:e,data:s||{}};return electron&&t?u(r):n.fetchauth("manage",r)},s.api={get:{settings:function(){return s.request("get.settings",{})}}},s.rpc=function(e,n,t){return u({path:"/rpc/*",data:{method:e,parameters:n,options:t||{}}})},s.fetch=function(e,n){return u({path:"/"+e,data:n})},s.wsssend=function(e){return u({wssdummy:!0,data:e})},s.listen=function(){electron&&t&&(electron.ipcRenderer.on("proxy-message",c),electron.ipcRenderer.on("proxy-message-tick",a),electron.ipcRenderer.on("wssdummy",i))},s.stop=function(){electron&&t&&(electron.ipcRenderer.off("proxy-message",c),electron.ipcRenderer.off("proxy-message-tick",a),electron.ipcRenderer.off("wssdummy",i))},s};"undefined"!=typeof module?module.exports={System16:System16}:window.System16;